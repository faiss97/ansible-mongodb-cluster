# =============================================================================
# MongoDB Mongos Configuration File
# =============================================================================
# Generated by Ansible - Do not edit manually
# Managed by: ansible-mongodb-cluster role
# Generated on: {{ ansible_date_time.iso8601 }}
# =============================================================================

# -----------------------------------------------------------------------------
# System Log Settings
# -----------------------------------------------------------------------------
systemLog:
  destination: {{ mongodb_log_destination }}
{% if mongodb_log_destination == 'file' %}
  path: {{ mongodb_log_directory }}/mongos.log
  logAppend: {{ mongodb_log_append | lower }}
  logRotate: {{ mongodb_log_rotate }}
{% endif %}
  verbosity: {{ mongodb_log_verbosity }}

# -----------------------------------------------------------------------------
# Process Management
# -----------------------------------------------------------------------------
processManagement:
  fork: true
  pidFilePath: {{ mongodb_pid_directory }}/mongos.pid

# -----------------------------------------------------------------------------
# Network Settings
# -----------------------------------------------------------------------------
net:
  port: {{ mongodb_mongos_port }}
  bindIp: {{ mongodb_bind_ip }}
{% if mongodb_ipv6 %}
  ipv6: true
{% endif %}
  maxIncomingConnections: {{ mongodb_max_connections }}
{% if mongodb_tls_enabled %}
  tls:
    mode: {{ mongodb_tls_mode }}
    certificateKeyFile: {{ mongodb_tls_certificate_key_file }}
{% if mongodb_tls_ca_file %}
    CAFile: {{ mongodb_tls_ca_file }}
{% endif %}
{% endif %}

# -----------------------------------------------------------------------------
# Sharding Configuration
# -----------------------------------------------------------------------------
sharding:
  configDB: {{ _mongodb_config_server_string }}

# -----------------------------------------------------------------------------
# Security Settings
# -----------------------------------------------------------------------------
{% if mongodb_security_auth_enabled %}
security:
  keyFile: {{ mongodb_keyfile_path }}
{% if mongodb_tls_enabled and mongodb_tls_cluster_auth_mode %}
  clusterAuthMode: {{ mongodb_tls_cluster_auth_mode }}
{% endif %}
{% endif %}
