# MongoDB Log Rotation Configuration
# Generated by Ansible - Do not edit manually

{{ mongodb_log_directory }}/*.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0640 {{ mongodb_user }} {{ mongodb_group }}
    sharedscripts
    postrotate
        /usr/bin/mongosh --host localhost --port {{ mongodb_port }} \
{% if mongodb_security_auth_enabled %}
            -u {{ mongodb_admin_user }} -p '{{ mongodb_admin_password }}' \
            --authenticationDatabase admin \
{% endif %}
            --eval "db.adminCommand({ logRotate: 1 })" > /dev/null 2>&1 || true
    endscript
}
